{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Moore-Penrose Generalized Inverse"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## create an example X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "set.seed(123)\n",
    "X = data.frame(x = rnorm(10), y = rnorm(10))\n",
    "X$z = X$x + X$y\n",
    "X = as.matrix(X)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Perform SVD decomposition of X to get MP g-inv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] 6.598543e+00 1.953962e+00 7.375275e-16\n",
      "[1] 1.515486e-01 5.117807e-01 1.355882e+15\n"
     ]
    }
   ],
   "source": [
    "lst = svd(X)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get the lambda inverse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "d = lst$d\n",
    "dinv = 1/d\n",
    "dinv[3] = 0\n",
    "\n",
    "print(d)\n",
    "print(dinv)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get the Matrices $U$, $D$, $D^-$, $V$ "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "U   = lst$u\n",
    "D    = diag(d)\n",
    "Dinv = diag(dinv)\n",
    "V    = lst$v"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Double check about the SVD decomposition"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 10 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>x</th><th scope=col>y</th><th scope=col>z</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>-0.56047565</td><td> 1.2240818</td><td> 0.66360615</td></tr>\n",
       "\t<tr><td>-0.23017749</td><td> 0.3598138</td><td> 0.12963634</td></tr>\n",
       "\t<tr><td> 1.55870831</td><td> 0.4007715</td><td> 1.95947976</td></tr>\n",
       "\t<tr><td> 0.07050839</td><td> 0.1106827</td><td> 0.18119111</td></tr>\n",
       "\t<tr><td> 0.12928774</td><td>-0.5558411</td><td>-0.42655340</td></tr>\n",
       "\t<tr><td> 1.71506499</td><td> 1.7869131</td><td> 3.50197812</td></tr>\n",
       "\t<tr><td> 0.46091621</td><td> 0.4978505</td><td> 0.95876668</td></tr>\n",
       "\t<tr><td>-1.26506123</td><td>-1.9666172</td><td>-3.23167839</td></tr>\n",
       "\t<tr><td>-0.68685285</td><td> 0.7013559</td><td> 0.01450305</td></tr>\n",
       "\t<tr><td>-0.44566197</td><td>-0.4727914</td><td>-0.91845338</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 10 × 3 of type dbl\n",
       "\\begin{tabular}{lll}\n",
       " x & y & z\\\\\n",
       "\\hline\n",
       "\t -0.56047565 &  1.2240818 &  0.66360615\\\\\n",
       "\t -0.23017749 &  0.3598138 &  0.12963634\\\\\n",
       "\t  1.55870831 &  0.4007715 &  1.95947976\\\\\n",
       "\t  0.07050839 &  0.1106827 &  0.18119111\\\\\n",
       "\t  0.12928774 & -0.5558411 & -0.42655340\\\\\n",
       "\t  1.71506499 &  1.7869131 &  3.50197812\\\\\n",
       "\t  0.46091621 &  0.4978505 &  0.95876668\\\\\n",
       "\t -1.26506123 & -1.9666172 & -3.23167839\\\\\n",
       "\t -0.68685285 &  0.7013559 &  0.01450305\\\\\n",
       "\t -0.44566197 & -0.4727914 & -0.91845338\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 10 × 3 of type dbl\n",
       "\n",
       "| x | y | z |\n",
       "|---|---|---|\n",
       "| -0.56047565 |  1.2240818 |  0.66360615 |\n",
       "| -0.23017749 |  0.3598138 |  0.12963634 |\n",
       "|  1.55870831 |  0.4007715 |  1.95947976 |\n",
       "|  0.07050839 |  0.1106827 |  0.18119111 |\n",
       "|  0.12928774 | -0.5558411 | -0.42655340 |\n",
       "|  1.71506499 |  1.7869131 |  3.50197812 |\n",
       "|  0.46091621 |  0.4978505 |  0.95876668 |\n",
       "| -1.26506123 | -1.9666172 | -3.23167839 |\n",
       "| -0.68685285 |  0.7013559 |  0.01450305 |\n",
       "| -0.44566197 | -0.4727914 | -0.91845338 |\n",
       "\n"
      ],
      "text/plain": [
       "      x           y          z          \n",
       " [1,] -0.56047565  1.2240818  0.66360615\n",
       " [2,] -0.23017749  0.3598138  0.12963634\n",
       " [3,]  1.55870831  0.4007715  1.95947976\n",
       " [4,]  0.07050839  0.1106827  0.18119111\n",
       " [5,]  0.12928774 -0.5558411 -0.42655340\n",
       " [6,]  1.71506499  1.7869131  3.50197812\n",
       " [7,]  0.46091621  0.4978505  0.95876668\n",
       " [8,] -1.26506123 -1.9666172 -3.23167839\n",
       " [9,] -0.68685285  0.7013559  0.01450305\n",
       "[10,] -0.44566197 -0.4727914 -0.91845338"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "X"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "recreate X from $X=UDV^T$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 10 × 3 of type dbl</caption>\n",
       "<tbody>\n",
       "\t<tr><td>-0.56047565</td><td> 1.2240818</td><td> 0.66360615</td></tr>\n",
       "\t<tr><td>-0.23017749</td><td> 0.3598138</td><td> 0.12963634</td></tr>\n",
       "\t<tr><td> 1.55870831</td><td> 0.4007715</td><td> 1.95947976</td></tr>\n",
       "\t<tr><td> 0.07050839</td><td> 0.1106827</td><td> 0.18119111</td></tr>\n",
       "\t<tr><td> 0.12928774</td><td>-0.5558411</td><td>-0.42655340</td></tr>\n",
       "\t<tr><td> 1.71506499</td><td> 1.7869131</td><td> 3.50197812</td></tr>\n",
       "\t<tr><td> 0.46091621</td><td> 0.4978505</td><td> 0.95876668</td></tr>\n",
       "\t<tr><td>-1.26506123</td><td>-1.9666172</td><td>-3.23167839</td></tr>\n",
       "\t<tr><td>-0.68685285</td><td> 0.7013559</td><td> 0.01450305</td></tr>\n",
       "\t<tr><td>-0.44566197</td><td>-0.4727914</td><td>-0.91845338</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 10 × 3 of type dbl\n",
       "\\begin{tabular}{lll}\n",
       "\t -0.56047565 &  1.2240818 &  0.66360615\\\\\n",
       "\t -0.23017749 &  0.3598138 &  0.12963634\\\\\n",
       "\t  1.55870831 &  0.4007715 &  1.95947976\\\\\n",
       "\t  0.07050839 &  0.1106827 &  0.18119111\\\\\n",
       "\t  0.12928774 & -0.5558411 & -0.42655340\\\\\n",
       "\t  1.71506499 &  1.7869131 &  3.50197812\\\\\n",
       "\t  0.46091621 &  0.4978505 &  0.95876668\\\\\n",
       "\t -1.26506123 & -1.9666172 & -3.23167839\\\\\n",
       "\t -0.68685285 &  0.7013559 &  0.01450305\\\\\n",
       "\t -0.44566197 & -0.4727914 & -0.91845338\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 10 × 3 of type dbl\n",
       "\n",
       "| -0.56047565 |  1.2240818 |  0.66360615 |\n",
       "| -0.23017749 |  0.3598138 |  0.12963634 |\n",
       "|  1.55870831 |  0.4007715 |  1.95947976 |\n",
       "|  0.07050839 |  0.1106827 |  0.18119111 |\n",
       "|  0.12928774 | -0.5558411 | -0.42655340 |\n",
       "|  1.71506499 |  1.7869131 |  3.50197812 |\n",
       "|  0.46091621 |  0.4978505 |  0.95876668 |\n",
       "| -1.26506123 | -1.9666172 | -3.23167839 |\n",
       "| -0.68685285 |  0.7013559 |  0.01450305 |\n",
       "| -0.44566197 | -0.4727914 | -0.91845338 |\n",
       "\n"
      ],
      "text/plain": [
       "      [,1]        [,2]       [,3]       \n",
       " [1,] -0.56047565  1.2240818  0.66360615\n",
       " [2,] -0.23017749  0.3598138  0.12963634\n",
       " [3,]  1.55870831  0.4007715  1.95947976\n",
       " [4,]  0.07050839  0.1106827  0.18119111\n",
       " [5,]  0.12928774 -0.5558411 -0.42655340\n",
       " [6,]  1.71506499  1.7869131  3.50197812\n",
       " [7,]  0.46091621  0.4978505  0.95876668\n",
       " [8,] -1.26506123 -1.9666172 -3.23167839\n",
       " [9,] -0.68685285  0.7013559  0.01450305\n",
       "[10,] -0.44566197 -0.4727914 -0.91845338"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "U %*% D %*% t(V)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Calculate MP generalized inverse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 3 × 10 of type dbl</caption>\n",
       "<tbody>\n",
       "\t<tr><td>-0.225000454</td><td>-0.0762018276</td><td> 0.19431346</td><td>-0.001704248</td><td> 0.082909582</td><td>0.06119839</td><td>0.014448375</td><td> 0.02839479</td><td>-0.185170934</td><td>-0.014943309</td></tr>\n",
       "\t<tr><td> 0.230363685</td><td> 0.0758769909</td><td>-0.14192886</td><td> 0.005710895</td><td>-0.088983787</td><td>0.02024699</td><td>0.007751459</td><td>-0.09994154</td><td> 0.177616056</td><td>-0.006370011</td></tr>\n",
       "\t<tr><td> 0.005363232</td><td>-0.0003248367</td><td> 0.05238461</td><td> 0.004006648</td><td>-0.006074205</td><td>0.08144538</td><td>0.022199834</td><td>-0.07154674</td><td>-0.007554878</td><td>-0.021313320</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 3 × 10 of type dbl\n",
       "\\begin{tabular}{llllllllll}\n",
       "\t -0.225000454 & -0.0762018276 &  0.19431346 & -0.001704248 &  0.082909582 & 0.06119839 & 0.014448375 &  0.02839479 & -0.185170934 & -0.014943309\\\\\n",
       "\t  0.230363685 &  0.0758769909 & -0.14192886 &  0.005710895 & -0.088983787 & 0.02024699 & 0.007751459 & -0.09994154 &  0.177616056 & -0.006370011\\\\\n",
       "\t  0.005363232 & -0.0003248367 &  0.05238461 &  0.004006648 & -0.006074205 & 0.08144538 & 0.022199834 & -0.07154674 & -0.007554878 & -0.021313320\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 3 × 10 of type dbl\n",
       "\n",
       "| -0.225000454 | -0.0762018276 |  0.19431346 | -0.001704248 |  0.082909582 | 0.06119839 | 0.014448375 |  0.02839479 | -0.185170934 | -0.014943309 |\n",
       "|  0.230363685 |  0.0758769909 | -0.14192886 |  0.005710895 | -0.088983787 | 0.02024699 | 0.007751459 | -0.09994154 |  0.177616056 | -0.006370011 |\n",
       "|  0.005363232 | -0.0003248367 |  0.05238461 |  0.004006648 | -0.006074205 | 0.08144538 | 0.022199834 | -0.07154674 | -0.007554878 | -0.021313320 |\n",
       "\n"
      ],
      "text/plain": [
       "     [,1]         [,2]          [,3]        [,4]         [,5]        \n",
       "[1,] -0.225000454 -0.0762018276  0.19431346 -0.001704248  0.082909582\n",
       "[2,]  0.230363685  0.0758769909 -0.14192886  0.005710895 -0.088983787\n",
       "[3,]  0.005363232 -0.0003248367  0.05238461  0.004006648 -0.006074205\n",
       "     [,6]       [,7]        [,8]        [,9]         [,10]       \n",
       "[1,] 0.06119839 0.014448375  0.02839479 -0.185170934 -0.014943309\n",
       "[2,] 0.02024699 0.007751459 -0.09994154  0.177616056 -0.006370011\n",
       "[3,] 0.08144538 0.022199834 -0.07154674 -0.007554878 -0.021313320"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "Xinv = t(U %*% Dinv %*% t(V))\n",
    "Xinv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] 10  3\n",
      "[1]  3 10\n"
     ]
    }
   ],
   "source": [
    "print(dim(X))\n",
    "print(dim(Xinv))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Prove that the results is a generalized inverse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 10 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>x</th><th scope=col>y</th><th scope=col>z</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>-0.56047565</td><td> 1.2240818</td><td> 0.66360615</td></tr>\n",
       "\t<tr><td>-0.23017749</td><td> 0.3598138</td><td> 0.12963634</td></tr>\n",
       "\t<tr><td> 1.55870831</td><td> 0.4007715</td><td> 1.95947976</td></tr>\n",
       "\t<tr><td> 0.07050839</td><td> 0.1106827</td><td> 0.18119111</td></tr>\n",
       "\t<tr><td> 0.12928774</td><td>-0.5558411</td><td>-0.42655340</td></tr>\n",
       "\t<tr><td> 1.71506499</td><td> 1.7869131</td><td> 3.50197812</td></tr>\n",
       "\t<tr><td> 0.46091621</td><td> 0.4978505</td><td> 0.95876668</td></tr>\n",
       "\t<tr><td>-1.26506123</td><td>-1.9666172</td><td>-3.23167839</td></tr>\n",
       "\t<tr><td>-0.68685285</td><td> 0.7013559</td><td> 0.01450305</td></tr>\n",
       "\t<tr><td>-0.44566197</td><td>-0.4727914</td><td>-0.91845338</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 10 × 3 of type dbl\n",
       "\\begin{tabular}{lll}\n",
       " x & y & z\\\\\n",
       "\\hline\n",
       "\t -0.56047565 &  1.2240818 &  0.66360615\\\\\n",
       "\t -0.23017749 &  0.3598138 &  0.12963634\\\\\n",
       "\t  1.55870831 &  0.4007715 &  1.95947976\\\\\n",
       "\t  0.07050839 &  0.1106827 &  0.18119111\\\\\n",
       "\t  0.12928774 & -0.5558411 & -0.42655340\\\\\n",
       "\t  1.71506499 &  1.7869131 &  3.50197812\\\\\n",
       "\t  0.46091621 &  0.4978505 &  0.95876668\\\\\n",
       "\t -1.26506123 & -1.9666172 & -3.23167839\\\\\n",
       "\t -0.68685285 &  0.7013559 &  0.01450305\\\\\n",
       "\t -0.44566197 & -0.4727914 & -0.91845338\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 10 × 3 of type dbl\n",
       "\n",
       "| x | y | z |\n",
       "|---|---|---|\n",
       "| -0.56047565 |  1.2240818 |  0.66360615 |\n",
       "| -0.23017749 |  0.3598138 |  0.12963634 |\n",
       "|  1.55870831 |  0.4007715 |  1.95947976 |\n",
       "|  0.07050839 |  0.1106827 |  0.18119111 |\n",
       "|  0.12928774 | -0.5558411 | -0.42655340 |\n",
       "|  1.71506499 |  1.7869131 |  3.50197812 |\n",
       "|  0.46091621 |  0.4978505 |  0.95876668 |\n",
       "| -1.26506123 | -1.9666172 | -3.23167839 |\n",
       "| -0.68685285 |  0.7013559 |  0.01450305 |\n",
       "| -0.44566197 | -0.4727914 | -0.91845338 |\n",
       "\n"
      ],
      "text/plain": [
       "      x           y          z          \n",
       " [1,] -0.56047565  1.2240818  0.66360615\n",
       " [2,] -0.23017749  0.3598138  0.12963634\n",
       " [3,]  1.55870831  0.4007715  1.95947976\n",
       " [4,]  0.07050839  0.1106827  0.18119111\n",
       " [5,]  0.12928774 -0.5558411 -0.42655340\n",
       " [6,]  1.71506499  1.7869131  3.50197812\n",
       " [7,]  0.46091621  0.4978505  0.95876668\n",
       " [8,] -1.26506123 -1.9666172 -3.23167839\n",
       " [9,] -0.68685285  0.7013559  0.01450305\n",
       "[10,] -0.44566197 -0.4727914 -0.91845338"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "X %*% Xinv %*% X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 10 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>x</th><th scope=col>y</th><th scope=col>z</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>-0.56047565</td><td> 1.2240818</td><td> 0.66360615</td></tr>\n",
       "\t<tr><td>-0.23017749</td><td> 0.3598138</td><td> 0.12963634</td></tr>\n",
       "\t<tr><td> 1.55870831</td><td> 0.4007715</td><td> 1.95947976</td></tr>\n",
       "\t<tr><td> 0.07050839</td><td> 0.1106827</td><td> 0.18119111</td></tr>\n",
       "\t<tr><td> 0.12928774</td><td>-0.5558411</td><td>-0.42655340</td></tr>\n",
       "\t<tr><td> 1.71506499</td><td> 1.7869131</td><td> 3.50197812</td></tr>\n",
       "\t<tr><td> 0.46091621</td><td> 0.4978505</td><td> 0.95876668</td></tr>\n",
       "\t<tr><td>-1.26506123</td><td>-1.9666172</td><td>-3.23167839</td></tr>\n",
       "\t<tr><td>-0.68685285</td><td> 0.7013559</td><td> 0.01450305</td></tr>\n",
       "\t<tr><td>-0.44566197</td><td>-0.4727914</td><td>-0.91845338</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 10 × 3 of type dbl\n",
       "\\begin{tabular}{lll}\n",
       " x & y & z\\\\\n",
       "\\hline\n",
       "\t -0.56047565 &  1.2240818 &  0.66360615\\\\\n",
       "\t -0.23017749 &  0.3598138 &  0.12963634\\\\\n",
       "\t  1.55870831 &  0.4007715 &  1.95947976\\\\\n",
       "\t  0.07050839 &  0.1106827 &  0.18119111\\\\\n",
       "\t  0.12928774 & -0.5558411 & -0.42655340\\\\\n",
       "\t  1.71506499 &  1.7869131 &  3.50197812\\\\\n",
       "\t  0.46091621 &  0.4978505 &  0.95876668\\\\\n",
       "\t -1.26506123 & -1.9666172 & -3.23167839\\\\\n",
       "\t -0.68685285 &  0.7013559 &  0.01450305\\\\\n",
       "\t -0.44566197 & -0.4727914 & -0.91845338\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 10 × 3 of type dbl\n",
       "\n",
       "| x | y | z |\n",
       "|---|---|---|\n",
       "| -0.56047565 |  1.2240818 |  0.66360615 |\n",
       "| -0.23017749 |  0.3598138 |  0.12963634 |\n",
       "|  1.55870831 |  0.4007715 |  1.95947976 |\n",
       "|  0.07050839 |  0.1106827 |  0.18119111 |\n",
       "|  0.12928774 | -0.5558411 | -0.42655340 |\n",
       "|  1.71506499 |  1.7869131 |  3.50197812 |\n",
       "|  0.46091621 |  0.4978505 |  0.95876668 |\n",
       "| -1.26506123 | -1.9666172 | -3.23167839 |\n",
       "| -0.68685285 |  0.7013559 |  0.01450305 |\n",
       "| -0.44566197 | -0.4727914 | -0.91845338 |\n",
       "\n"
      ],
      "text/plain": [
       "      x           y          z          \n",
       " [1,] -0.56047565  1.2240818  0.66360615\n",
       " [2,] -0.23017749  0.3598138  0.12963634\n",
       " [3,]  1.55870831  0.4007715  1.95947976\n",
       " [4,]  0.07050839  0.1106827  0.18119111\n",
       " [5,]  0.12928774 -0.5558411 -0.42655340\n",
       " [6,]  1.71506499  1.7869131  3.50197812\n",
       " [7,]  0.46091621  0.4978505  0.95876668\n",
       " [8,] -1.26506123 -1.9666172 -3.23167839\n",
       " [9,] -0.68685285  0.7013559  0.01450305\n",
       "[10,] -0.44566197 -0.4727914 -0.91845338"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "X"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Find MP generalized inverse using package"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "library(MASS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 3 × 10 of type dbl</caption>\n",
       "<tbody>\n",
       "\t<tr><td>-0.225000454</td><td>-0.0762018276</td><td> 0.19431346</td><td>-0.001704248</td><td> 0.082909582</td><td>0.06119839</td><td>0.014448375</td><td> 0.02839479</td><td>-0.185170934</td><td>-0.014943309</td></tr>\n",
       "\t<tr><td> 0.230363685</td><td> 0.0758769909</td><td>-0.14192886</td><td> 0.005710895</td><td>-0.088983787</td><td>0.02024699</td><td>0.007751459</td><td>-0.09994154</td><td> 0.177616056</td><td>-0.006370011</td></tr>\n",
       "\t<tr><td> 0.005363232</td><td>-0.0003248367</td><td> 0.05238461</td><td> 0.004006648</td><td>-0.006074205</td><td>0.08144538</td><td>0.022199834</td><td>-0.07154674</td><td>-0.007554878</td><td>-0.021313320</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 3 × 10 of type dbl\n",
       "\\begin{tabular}{llllllllll}\n",
       "\t -0.225000454 & -0.0762018276 &  0.19431346 & -0.001704248 &  0.082909582 & 0.06119839 & 0.014448375 &  0.02839479 & -0.185170934 & -0.014943309\\\\\n",
       "\t  0.230363685 &  0.0758769909 & -0.14192886 &  0.005710895 & -0.088983787 & 0.02024699 & 0.007751459 & -0.09994154 &  0.177616056 & -0.006370011\\\\\n",
       "\t  0.005363232 & -0.0003248367 &  0.05238461 &  0.004006648 & -0.006074205 & 0.08144538 & 0.022199834 & -0.07154674 & -0.007554878 & -0.021313320\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 3 × 10 of type dbl\n",
       "\n",
       "| -0.225000454 | -0.0762018276 |  0.19431346 | -0.001704248 |  0.082909582 | 0.06119839 | 0.014448375 |  0.02839479 | -0.185170934 | -0.014943309 |\n",
       "|  0.230363685 |  0.0758769909 | -0.14192886 |  0.005710895 | -0.088983787 | 0.02024699 | 0.007751459 | -0.09994154 |  0.177616056 | -0.006370011 |\n",
       "|  0.005363232 | -0.0003248367 |  0.05238461 |  0.004006648 | -0.006074205 | 0.08144538 | 0.022199834 | -0.07154674 | -0.007554878 | -0.021313320 |\n",
       "\n"
      ],
      "text/plain": [
       "     [,1]         [,2]          [,3]        [,4]         [,5]        \n",
       "[1,] -0.225000454 -0.0762018276  0.19431346 -0.001704248  0.082909582\n",
       "[2,]  0.230363685  0.0758769909 -0.14192886  0.005710895 -0.088983787\n",
       "[3,]  0.005363232 -0.0003248367  0.05238461  0.004006648 -0.006074205\n",
       "     [,6]       [,7]        [,8]        [,9]         [,10]       \n",
       "[1,] 0.06119839 0.014448375  0.02839479 -0.185170934 -0.014943309\n",
       "[2,] 0.02024699 0.007751459 -0.09994154  0.177616056 -0.006370011\n",
       "[3,] 0.08144538 0.022199834 -0.07154674 -0.007554878 -0.021313320"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "ginv(X)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "compare to what have been calculated above"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<caption>A matrix: 3 × 10 of type dbl</caption>\n",
       "<tbody>\n",
       "\t<tr><td>-0.225000454</td><td>-0.0762018276</td><td> 0.19431346</td><td>-0.001704248</td><td> 0.082909582</td><td>0.06119839</td><td>0.014448375</td><td> 0.02839479</td><td>-0.185170934</td><td>-0.014943309</td></tr>\n",
       "\t<tr><td> 0.230363685</td><td> 0.0758769909</td><td>-0.14192886</td><td> 0.005710895</td><td>-0.088983787</td><td>0.02024699</td><td>0.007751459</td><td>-0.09994154</td><td> 0.177616056</td><td>-0.006370011</td></tr>\n",
       "\t<tr><td> 0.005363232</td><td>-0.0003248367</td><td> 0.05238461</td><td> 0.004006648</td><td>-0.006074205</td><td>0.08144538</td><td>0.022199834</td><td>-0.07154674</td><td>-0.007554878</td><td>-0.021313320</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 3 × 10 of type dbl\n",
       "\\begin{tabular}{llllllllll}\n",
       "\t -0.225000454 & -0.0762018276 &  0.19431346 & -0.001704248 &  0.082909582 & 0.06119839 & 0.014448375 &  0.02839479 & -0.185170934 & -0.014943309\\\\\n",
       "\t  0.230363685 &  0.0758769909 & -0.14192886 &  0.005710895 & -0.088983787 & 0.02024699 & 0.007751459 & -0.09994154 &  0.177616056 & -0.006370011\\\\\n",
       "\t  0.005363232 & -0.0003248367 &  0.05238461 &  0.004006648 & -0.006074205 & 0.08144538 & 0.022199834 & -0.07154674 & -0.007554878 & -0.021313320\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 3 × 10 of type dbl\n",
       "\n",
       "| -0.225000454 | -0.0762018276 |  0.19431346 | -0.001704248 |  0.082909582 | 0.06119839 | 0.014448375 |  0.02839479 | -0.185170934 | -0.014943309 |\n",
       "|  0.230363685 |  0.0758769909 | -0.14192886 |  0.005710895 | -0.088983787 | 0.02024699 | 0.007751459 | -0.09994154 |  0.177616056 | -0.006370011 |\n",
       "|  0.005363232 | -0.0003248367 |  0.05238461 |  0.004006648 | -0.006074205 | 0.08144538 | 0.022199834 | -0.07154674 | -0.007554878 | -0.021313320 |\n",
       "\n"
      ],
      "text/plain": [
       "     [,1]         [,2]          [,3]        [,4]         [,5]        \n",
       "[1,] -0.225000454 -0.0762018276  0.19431346 -0.001704248  0.082909582\n",
       "[2,]  0.230363685  0.0758769909 -0.14192886  0.005710895 -0.088983787\n",
       "[3,]  0.005363232 -0.0003248367  0.05238461  0.004006648 -0.006074205\n",
       "     [,6]       [,7]        [,8]        [,9]         [,10]       \n",
       "[1,] 0.06119839 0.014448375  0.02839479 -0.185170934 -0.014943309\n",
       "[2,] 0.02024699 0.007751459 -0.09994154  0.177616056 -0.006370011\n",
       "[3,] 0.08144538 0.022199834 -0.07154674 -0.007554878 -0.021313320"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "Xinv"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "3.6.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
